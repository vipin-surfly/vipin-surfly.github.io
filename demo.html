<html>
  <script>
   (function(s,u,r,f,l,y){s[f]=s[f]||{init:function(){s[f].q=arguments}};
l=u.createElement(r);y=u.getElementsByTagName(r)[0];l.async=1;
l.src='https://surfly.com/surfly.js';y.parentNode.insertBefore(l,y);})
(window,document,'script','Surfly');

var settings = {
    // Surfly session options can be set here, or at the Company/Plan levels.
    widget_key: '513065a5492743e6a6340aec09b7e4d1',
};

Surfly.init(settings, function(initResult) {
    if (initResult.success) {

      Surfly.on("session_started", ()=> {
Surfly.listSessions()[0].on('message', function(session, event) {
          console.log("HELLO: "+event.data.message);
});
        Surfly.on("session_restored", ()=> {
Surfly.listSessions()[0].on('message', function(session, event) {
          console.log("HELLO: "+event.data.message);
});
        // API calls can now be made!
        if (!Surfly.isInsideSession) {
            Surfly.button();
        }
      else {
    Surfly.currentSession.on('message', function(session, event) {
      console.log("HHH "+event.data.message);
       Surfly.currentSession.sendMessage({message: 'Recvd'}, window.location.origin);
    });
  }
    } 
  });
function myFunction() {
 Surfly.listSessions()[0].sendMessage({message: 'ALL good'}, window.location.origin);
}
  </script>
   <button id="btn-end-queued-session" type="button" onclick="myFunction()">Click Me!</button> 
</html>
